/**
 * Modules in this bundle
 * @license
 *
 * tank-battle:
 *   author: Hänsel
 *   version: 1.1.1
 *
 * This header is generated by licensify (https://github.com/twada/licensify)
 */
!function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[a]={exports:{}};e[a][0].call(u.exports,function(t){var i=e[a][1][t];return o(i||t)},u,u.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){(function(e){(function(){function n(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function o(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function r(t,e){for(var i in e)t[i]=e[i];return t}var a,s,l,h,u,d,c=void 0!==i&&i||this;a="undefined"!=typeof window?window.phina:void 0!==e?e.phina:null,s=a.display,l=a.geom,h=t("../util/object2d").setOrigin2,u=t("../tank/tank").Tank,d=t("./wall").Wall,c.BattleField=function(t){function e(t){var e,n,o,a,h,u,c,f,p,y,w,g,m,_=this instanceof i?this:new i;return _.init(r({fill:"#db8",stroke:!1,padding:0},t)),20,e=[_.width/2,_.height/2],n=e[0],o=e[1],e=[n-20,o-20],a=e[0],h=e[1],e=[n-10,o-10],u=e[0],c=e[1],e=[_.width,_.height].map(function(t){return t-40}),f=e[0],p=e[1],_.enemyField=l.Rect(-a,-h,f,h-10),(_.myField=_.enemyField.clone()).y+=h+10,[_.myField,_.enemyField].each(function(t){return s.RectangleShape({width:t.width,height:t.height,fill:"#ec9",stroke:!1,padding:0}).addChildTo(_).setPosition(t.centerX,t.centerY).permeable=!0}),_.addChild(d({y:-c,width:_.width,height:20})),_.addChild(d({x:-u,width:20,height:p})),e=[5,.8],y=e[0],w=e[1],g=f*w/(w*y+y-1),m=g*(1+1/w),y.times(function(t){return d({x:g/2-a+m*t,width:g,height:20,hp:200}).addChildTo(_)}),_.addChild(d({x:u,width:20,height:p})),_.addChild(d({y:c,width:_.width,height:20})),_._enemyNum=0,_.on("killed",function(t){return"me"===t.tank.side?this.parent.flare("defeated"):(this.parent.flare("score"),(this._enemyNum-=1)<=0?this.parent.flare("win"):void 0)}),_}function i(){}var a=n((o(e,t).displayName="BattleField",e),t).prototype;return i.prototype=a,e.prototype.addTank=function(t){return t.addChildTo(this),"me"===t.side?(t.setPosition(this.myField.centerX,this.myField.centerY).setRotation(-90),this._myTank=t):(t.setPosition(this._enemyX(),this.enemyField.centerY).setRotation(90),this._enemyNum+=1),this},e.prototype.whiteIn=function(t){var e,i,n,o,r,a,s,l=this;return e=this.x,i=this.y,n=this.originX,o=this.originY,this._setOriginMyTank(),r=[this.x,this.y],a=r[0],s=r[1],this.tweener.clear().set({x:e,y:i,scaleX:4,scaleY:4,rotation:360,alpha:0}).wait(0).call(function(){return l.children.each(function(t){return t.sleep()})}).to({x:a,y:s,scaleX:1,scaleY:1,rotation:0,alpha:1},2e3,"easeOutCubic").call(function(){return h(l,n,o),l.children.each(function(t){return t.wakeUp()}),t()})},e.prototype.whiteOut=function(t){var e,i,n,o,r,a,s=this;for(e=0,n=(i=this.children).length;e<n;++e)(o=i[e])instanceof u&&o.escapeCrew();return r=this.x,a=this.y,this.tweener.clear().wait(500).call(function(){return s._setOriginMyTank()}).to({x:r,y:a,scaleX:4,scaleY:4,rotation:360,alpha:0},2e3,"easeInCubic").wait(500).call(t)},e.prototype._enemyX=function(){var t;return t=96*((this._enemyNum+1)/2).toInt(),this.enemyField.centerX+(this._enemyNum%2==0?t:-t)},e.prototype._setOriginMyTank=function(){var t,e;return null!=this._myTank&&(this.x,this.y,t=this._myTank.x/this.width+this.originX,e=this._myTank.y/this.height+this.originY,h(this,t,e)),this},e}(s.RectangleShape)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../tank/tank":20,"../util/object2d":23,"./wall":2}],2:[function(t,e,i){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function o(t,e){for(var i in e)t[i]=e[i];return t}var r,a=void 0!==i&&i||this;r=t("../ex/shadowedrectangle").ShadowedRectangle,a.Wall=function(t){function i(t){var e,n=this instanceof r?this:new r;return e=o({padding:12,fill:"#777",stroke:!1,originX:.5,originY:.5,x:0,y:0,shadow:"rgba(0, 0, 0, 0.7)",shadowBlur:12,shadowOffsetX:4,shadowOffsetY:4},t),i.superclass.call(n,e),n.setOrigin(e.originX,e.originY),n.setPosition(e.x,e.y),n._hp=n._hpMax=e.hp,n}function r(){}var a=e((n(i,t).displayName="Wall",i),t).prototype;return r.prototype=a,i.prototype.damaged=function(t){if(null!=this._hp&&(this._hp-=t,this.alpha=Math.max(this._hp/this._hpMax*.9+.1,0),this._hp<=0))return this.remove()},i}(r)}).call(this)},{"../ex/shadowedrectangle":10}],3:[function(t,e,i){(function(e){(function(){function n(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function o(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function r(t,e){for(var i in e)t[i]=e[i];return t}var a,s,l,h,u=void 0!==i&&i||this;s=(a="undefined"!=typeof window?window.phina:void 0!==e?e.phina:null).accessory,l=a.geom,h=t("../util/vector").applyMargin,u.ComCommander=function(t){function e(t,e,n,o){var a=this instanceof i?this:new i;return a._myField=t,a._enemyField=e,a._enemy=n,a._=r({moveRate:.05,gunRate:.05,missileRate:.02},o),a.init(),a}function i(){}var a=n((o(e,t).displayName="ComCommander",e),t).prototype;return i.prototype=a,e.prototype.update=function(t){var e,i,n,o;return e=30*t.deltaTime/1e3,this._isNextMove(e)&&(i=Math.randint(this._myField.left,this._myField.right),n=Math.randint(this._myField.top,this._myField.bottom),o=Math.max(this.target.width,this.target.height),this.target.cmdMove(h(l.Vector2(i,n),this._myField,o))),this._isFireGun(e)?this.target.cmdGun(this._enemy.position):this._isFireMissile(e)?this.target.cmdMissile(this._enemy.position):void 0},e.prototype._isNextMove=function(t){return!this.target.moving()&&Math.random()<this._.moveRate*t},e.prototype._isFireGun=function(t){return Math.random()<this._.gunRate*t},e.prototype._isFireMissile=function(t){return Math.random()<this._.missileRate*t},e}(s.Accessory)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/vector":24}],4:[function(t,e,i){(function(e){(function(){function n(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function o(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}var r,a,s=void 0!==i&&i||this;r=("undefined"!=typeof window?window.phina:void 0!==e?e.phina:null).accessory,a=t("../util/vector").applyMargin,s.PlayerCommander=function(t){function e(t,e){var n=this instanceof i?this:new i;return n._myField=t,n._enemyField=e,n.init(),n._tapTime=0,n}function i(){}var r=n((o(e,t).displayName="PlayerCommander",e),t).prototype;return i.prototype=r,e.prototype.update=function(t){var e;return t.pointer.getPointing()?(this._lastPointer=this.target.parent.globalToLocal(t.pointer.position),this._myField.contains(this._lastPointer.x,this._lastPointer.y)&&(e=Math.max(this.target.width,this.target.height),this.target.cmdMove(a(this._lastPointer,this._myField,e))),this._enemyField.contains(this._lastPointer.x,this._lastPointer.y)?this._tapTime+=t.deltaTime:this._tapTime=0):(0<this._tapTime&&(this._tapTime<this._longPress?this.target.cmdGun(this._lastPointer):this.target.cmdMissile(this._lastPointer)),this._tapTime=0)},e.prototype.isGunReady=function(){var t;return 0<(t=this._tapTime)&&t<this._longPress},e.prototype.isMissileReady=function(){return this._tapTime>=this._longPress},e.prototype._longPress=500,e}(r.Accessory)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/vector":24}],5:[function(t,e,i){e.exports={name:"tank-battle",title:"TANK BATTLE",version:"1.1.1",author:"Hänsel"}},{}],6:[function(t,e,i){(function(){(void 0!==i&&i||this).enemies={lightW:{width:40,height:20,hp:25,gunWait:45,speedMax:3.2,missileRate:0,turret:{barrelLength:1},shell:{width:8,height:3,damage:10}},lightS:{width:40,height:20,hp:50,accel:.3,speedMax:3.5,yawMax:12,gunWait:30,moveRate:.1,gunRate:.08,turret:{barrelLength:1},shell:{width:8,height:3,damage:15},missile:{width:10,height:3,yawMax:.5,seekAngle:30,damage:30}},middleW:{hp:75,speedMax:2.5,yawMax:8,missileRate:0,shell:{speed:10,damage:20}},middleS:{hp:100,moveRate:.1,gunRate:.08},heavyW:{width:56,height:28,hp:125,accel:.1,speedMax:2.5,yawMax:6,gunWait:90,missileWait:450,turret:{yawMax:10},shell:{speed:10},missile:{yawMax:.5,seekAngle:30}},heavyS:{width:56,height:28,hp:150,accel:.1,speedMax:2.8,yawMax:8,moveRate:.1,gunRate:.08,missileRate:.08,turret:{yawMax:15},shell:{speed:10,damage:35},missile:{damage:60}},fortressW:{width:80,height:40,hp:200,accel:.1,speedMax:1.5,yawMax:5,turret:{yawMax:5},shell:{width:12,height:6,speed:8,damage:40},missile:{width:16,height:6,speedMax:6,yawMax:.4,seekAngle:30,damage:80}},fortressS:{width:80,height:40,hp:400,accel:.1,speedMax:2,yawMax:5,gunWait:30,missileWait:150,moveRate:.1,gunRate:.08,missileRate:.08,turret:{yawMax:8},shell:{width:16,height:6,speed:10,damage:40},missile:{width:16,height:6,speedMax:6,damage:80}},missilerW:{hp:25,speedMax:2,yawMax:5,missileWait:90,gunRate:0,turret:{yawMax:4,barrelLength:.1},missile:{yawMax:.5,seekAngle:30}},missilerS:{hp:30,speedMax:2.5,yawMax:8,missileWait:90,moveRate:.1,gunRate:0,missileRate:.08,turret:{yawMax:6,barrelLength:.1},missile:{width:16,height:6,yawMax:.8,damage:80}}}}).call(this)},{}],7:[function(t,e,i){(function(){var e,n=void 0!==i&&i||this;e=t("./enemy").enemies,n.stages=[{enemy:[e.lightW]},{enemy:[e.lightW,e.lightW,e.lightW]},{enemy:[e.missilerW,e.missilerW,e.missilerW]},{enemy:[e.middleW,e.middleW,e.middleW]},{enemy:[e.heavyW,e.heavyW,e.heavyW]},{enemy:[e.lightW,e.lightW,e.lightW,e.lightW,e.lightW]},{enemy:[e.missilerW,e.missilerW,e.missilerW,e.missilerW,e.missilerW]},{enemy:[e.middleW,e.missilerW,e.missilerW,e.lightW,e.lightW]},{enemy:[e.fortressW,e.heavyW,e.heavyW,e.missilerW,e.missilerW]},{enemy:[e.lightS]},{enemy:[e.lightS,e.lightS,e.lightS]},{enemy:[e.missilerS,e.missilerS,e.missilerS]},{enemy:[e.middleS,e.middleS,e.middleS]},{enemy:[e.heavyS,e.heavyS,e.heavyS]},{enemy:[e.lightS,e.lightS,e.lightS,e.lightS,e.lightS]},{enemy:[e.missilerS,e.missilerS,e.missilerS,e.missilerS,e.missilerS]},{enemy:[e.middleS,e.missilerS,e.missilerS,e.lightS,e.lightS]},{enemy:[e.fortressS,e.heavyS,e.heavyS,e.missilerS,e.missilerS]}]}).call(this)},{"./enemy":6}],8:[function(t,e,i){(function(t){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function o(t,e){for(var i in e)t[i]=e[i];return t}function r(t){function e(){}return e.prototype=t,new e}var a,s,l,h=void 0!==i&&i||this;s=(a="undefined"!=typeof window?window.phina:void 0!==t?t.phina:null).accessory,l=a.geom,h.Motion=function(t){function i(t){var e=this instanceof a?this:new a;return e._=o(r(e._default),t),e.init(),e}function a(){}var s=e((n(i,t).displayName="Motion",i),t).prototype;return a.prototype=s,i.prototype.update=function(t){var e,i=this;return e=30*t.deltaTime/1e3,this._.resolution.times(function(){if(i.target.parent)return i._move(e)})},i.prototype._move=function(t){var e,i,n;if(0!==this._.yaw&&(e=this._.yaw*t/this._.resolution,this.target.rotation+=e,this.target.flare("rotate",{angle:e})),0!==this._.accel&&(i=this._.speed+this._.accel*t/this._.resolution,this._.speed=Math.clamp(i,this._.speedMin,this._.speedMax)),0!==this._.speed)return n=l.Vector2().fromDegree(this.target.rotation,this._.speed*t/this._.resolution),this.target.position.add(n),this.target.flare("move",{move:n})},Object.defineProperty(i.prototype,"accel",{get:function(){return this._.accel},set:function(t){this._.accel=Math.clamp(t,this._.accelMin,this._.accelMax)},configurable:!0,enumerable:!0}),Object.defineProperty(i.prototype,"yaw",{get:function(){return this._.yaw},set:function(t){this._.yaw=Math.clamp(t,-this._.yawMax,this._.yawMax)},configurable:!0,enumerable:!0}),i.prototype._default={speed:0,speedMin:0,speedMaxm:300,accel:0,accelMin:-100,accelMax:100,yaw:0,yawMax:100,resolution:1},i}(s.Accessory)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(t,e,i){(function(t){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function o(t,e){for(var i in e)t[i]=e[i];return t}var r,a,s,l=void 0!==i&&i||this;a=(r="undefined"!=typeof window?window.phina:void 0!==t?t.phina:null).display,s=r.geom,l.Particle=function(t){function i(t){var e=this instanceof r?this:new r;return e._=o({stroke:!1,direction:0,speed:0,jitter:0,animation:[{to:{alpha:0},duration:1e3,easing:"default"}]},t),e.init(e._),e.permeable=!0,e.physical.velocity=s.Vector2().fromDegree(e._.direction,e._.speed).add(s.Vector2().random().mul(Math.random()*e._.jitter)),e._.animation.each(function(t){return e.tweener.to(t.to,t.duration,t.easing)}),e.tweener.call(function(){return e.remove()}),e}function r(){}var a=e((n(i,t).displayName="Particle",i),t).prototype;return r.prototype=a,i}(a.CircleShape)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(t,e,i){(function(t){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}var o,r,a,s,l=void 0!==i&&i||this;r=(o="undefined"!=typeof window?window.phina:void 0!==t?t.phina:null).display,a=o.geom,l.ShadowedRectangle=function(t){function i(t){var e,i=this instanceof o?this:new o;return i.init(t),i.shadowOffsetX=null!=(e=t.shadowOffsetX)?e:0,i.shadowOffsetY=null!=(e=t.shadowOffsetY)?e:0,i._rotation=null!=(e=t.rotation)?e:0,i}function o(){}var r=e((n(i,t).displayName="ShadowedRectangle",i),t).prototype;return o.prototype=r,Object.defineProperty(i.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,!this.shadow||0===this.shadowOffsetX&&0===this.shadowOffsetY||(this._dirtyDraw=!0))},configurable:!0,enumerable:!0}),i.prototype.prerender=function(t){},i.prototype.renderFill=function(t){var e,i,n,o;return e=a.Vector2(this.shadowOffsetX,this.shadowOffsetY),i=s(this.rotation,this.parent),e.length()>0&&0!==i&&e.rotate(-i.toRadian()),n=this.canvas.context,this.shadow&&((o=n).shadowOffsetX=e.x,o.shadowOffsetY=e.y,o.shadowColor=this.shadow,o.shadowBlur=this.shadowBlur),t.fillRoundRect(-this.width/2,-this.height/2,this.width,this.height,this.cornerRadius)},i.prototype.renderStroke=function(t){return t.strokeRoundRect(-this.width/2,-this.height/2,this.width,this.height,this.cornerRadius)},i.prototype.postrender=function(){},i}(r.RectangleShape),s=function(t,e){return null!=(null!=e?e.rotation:void 0)?t+s(e.rotation,e.parent):t}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(t,e,i){(function(e){(function(){var i,n,o,r,a,s,l;i="undefined"!=typeof window?window.phina:void 0!==e?e.phina:null,n=i.game,o=t("meta"),r=t("./scene/mainscene").MainScene,a=t("./scene/titlescene").MyTitleScene,s=t("./scene/resultscene").MyResultScene,i.global.MainScene=r,i.global.MyTitleScene=a,i.global.MyResultScene=s,l=[{className:"MyTitleScene",label:"title",nextLabel:"main"},{className:"MainScene",label:"main",nextLabel:"result"},{className:"MyResultScene",label:"result",nextLabel:"title",arguments:{message:o.title+"\nVersion "+o.version+"\nscore: {score}\n",timeout:15}}],i.main(function(){var t,e;return t="#debug"===window.location.hash,e=n.GameApp({startLabel:"title",fps:60,scenes:l}),t&&e.enableStats(),e.run()})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./scene/mainscene":13,"./scene/resultscene":14,"./scene/titlescene":16,meta:5}],12:[function(t,e,i){(function(t){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function o(t,e){for(var i in e)t[i]=e[i];return t}function r(t){function e(){}return e.prototype=t,new e}var a,s,l,h,u=void 0!==i&&i||this;a="undefined"!=typeof window?window.phina:void 0!==t?t.phina:null,s=a.display,l=a.ui,h=a.util,u.FireGauge=function(t){function i(t){var e=this instanceof a?this:new a;return e._=o(r(e._default),t),e.init(e._),e.setBoundingType("circle"),e.radius=e._.radius,null!=e._.alpha&&(e.alpha=e._.alpha),e.animation=!1,e._.label&&(e._label=s.Label({fontSize:e._.fontSize,text:e._.label}).addChildTo(e).setPosition(0,e.height/2+12)),e.on("enterframe",function(){var t,e,i,n;return null!=this._.getValue&&(this.value=Math.clamp(this._.getValue(),0,this.maxValue)),t=this.isFull()&&("function"==typeof(e=this._).isFlashing?e.isFlashing():void 0),i=t&&this._.flashing?this._.flashing:this._.full,n=this.isFull()?i:this._.charging,this.fill=n.fill,this.alpha=n.alpha,null!=n.label&&o(this._label,n.label),this.flashing(t)}),e}function a(){}var l=e((n(i,t).displayName="FireGauge",i),t).prototype;return a.prototype=l,i.prototype.flashing=function(t){if(t){if(!this.tweener.playing)return this._.flashStart(this.tweener)}else if(this.tweener.playing)return this._.flashStop(this.tweener)},i.prototype.prerender=function(){},i.prototype.renderFill=function(t){var e;return t.rotate(.5*-Math.PI),0,e=2*Math.PI*this.getRate(),this._.gaugeColor&&(t.context.fillStyle=this._.gaugeColor,t.fillCircle(0,0,this.radius)),t.context.fillStyle=this.fill,t.fillPie(0,0,this.radius,0,e)},i.prototype.renderStroke=function(t){return t.strokeCircle(0,0,this.radius)},i.prototype._default={backgroundColor:"transparent",stroke:"#333",strokeWidth:2,radius:24,gaugeColor:"grey",fontSize:24,charging:{fill:"red",alpha:.5,label:{fill:"grey",fontWeight:"",shadow:!1}},full:{fill:"yellow",alpha:.7,label:{fill:"yellow",fontWeight:"bold",shadow:"black",shadowBlur:6}},flashing:{fill:"#7f7",alpha:.7,label:{fill:"#7f7",fontWeight:"bold",shadow:"black",shadowBlur:12}},flashStart:function(t){return t.clear().set({scaleX:1,scaleY:1,alpha:.7}).to({scaleX:1.5,scaleY:1.5,alpha:.2},500,h.Tween.easeInCubic).setLoop(!0).play()},flashStop:function(t){return t.clear().set({scaleX:1,scaleY:1,alpha:.7}).play()}},i.prototype.postrender=function(){},i}(l.Gauge)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(t,e,i){(function(e){(function(){function n(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function o(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function r(t){function e(){}return e.prototype=t,new e}var a,s,l,h,u,d,c,f,p,y,w,g=void 0!==i&&i||this;a="undefined"!=typeof window?window.phina:void 0!==e?e.phina:null,s=a.display,l=a.game,h=t("../commander/player-commander").PlayerCommander,u=t("../commander/com-commander").ComCommander,d=t("../tank/tank").Tank,c=t("../battlefield/battlefield").BattleField,f=t("../config/stage").stages,p=t("./firegauge").FireGauge,y=t("./stagetitlescene").StageTitleScene,g.MainScene=function(t){function e(t){var n,o,a,g,m,_,v,x,b=this instanceof i?this:new i;return n=t.score,o=t.stage,b.init(),null==n&&(n=0),o=null!=o?o+1:1,a=f[(o-1)%f.length],b._field=c((b.width,b.height,b)).setPosition(b.gridX.center(),b.gridY.center()).addChildTo(b),g=b._field,m=g.myField,_=g.enemyField,v=h(m,_),x=d({side:"me",fill:"#00f",marker:!0}).entry(b._field).attach(v),a.enemy.each(function(t,e){var i;return d((i=r(t),i.side="enemy",i.fill="#c00",i)).entry(b._field).attach(u(_,m,x,t))}),b._scoreLabel=s.Label({fontSize:32,fill:"white",shadow:"black",shadowBlur:6,align:"left",text:w(n)}).setPosition(48,48).addChildTo(b),b._gunGauge=p({label:"GUN",getValue:function(){return x.gunRate},isFlashing:function(){return v.isGunReady()}}).setPosition(b.width-128,b.height-80).addChildTo(b),b._missileGauge=p({label:"MSSL",getValue:function(){return x.missileRate},isFlashing:function(){return v.isMissileReady()}}).setPosition(b.width-64,b.height-80).addChildTo(b),b._hideOverlay(),b.on("enter",function(){return this.app.pushScene(y({text:"STAGE "+o}))}),b.on("resume",function(t){var e=this;if(t.prevScene instanceof y)return this._field.whiteIn(function(){return e._showOverlay()})}),b.on("blur",function(){var t;return null!=(t=this.app)?t.pushScene(l.PauseScene()):void 0}),b.on("score",function(){return n+=1,this._scoreLabel.text=w(n)}),b.on("defeated",function(){var t=this;if(!this._finish)return this._finish=!0,this._hideOverlay(),this._field.whiteOut(function(){return t.exit({score:n})})}),b.on("win",function(){var t=this;if(!this._finish)return x.permeable=!0,this._finish=!0,this._hideOverlay(),this._field.whiteOut(function(){return t.app.replaceScene(e({score:n,stage:o}))})}),b}function i(){}var a=n((o(e,t).displayName="MainScene",e),t).prototype;return i.prototype=a,e.prototype._showOverlay=function(){var t,e,i;return null!=(t=this._gunGauge)&&t.show(),null!=(e=this._missileGauge)&&e.show(),null!=(i=this._scoreLabel)?i.show():void 0},e.prototype._hideOverlay=function(){var t,e,i;return null!=(t=this._gunGauge)&&t.hide(),null!=(e=this._missileGauge)&&e.hide(),null!=(i=this._scoreLabel)?i.hide():void 0},e}(s.DisplayScene),w=function(t){return"score: "+t}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../battlefield/battlefield":1,"../commander/com-commander":3,"../commander/player-commander":4,"../config/stage":7,"../tank/tank":20,"./firegauge":12,"./stagetitlescene":15}],14:[function(t,e,i){(function(t){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}var o,r=void 0!==i&&i||this;o=("undefined"!=typeof window?window.phina:void 0!==t?t.phina:null).game,r.MyResultScene=function(t){function i(t){var e=this instanceof o?this:new o;return e.init(t),(null!=t.timeout)>0&&(e._timerId=setTimeout(function(){return e.exit()},1e3*t.timeout),e.on("exit",function(){return clearTimeout(this._timerId)})),e}function o(){}var r=e((n(i,t).displayName="MyResultScene",i),t).prototype;return o.prototype=r,i}(o.ResultScene)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(t,e,i){(function(t){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function o(t,e){for(var i in e)t[i]=e[i];return t}var r,a,s,l=void 0!==i&&i||this;r="undefined"!=typeof window?window.phina:void 0!==t?t.phina:null,a=r.display,s=r.game,l.StageTitleScene=function(t){function i(t){var e,i=this instanceof r?this:new r;return e=o({backgroundColor:"grey",fontColor:"white",fontSize:86},t),i.init(e),i._label=a.Label({fill:"white",fontSize:e.fontSize,text:e.text}).setPosition(i.gridX.center(),i.gridY.center()).addChildTo(i),i._label.tweener.clear().set({scaleX:0,scaleY:0,alpha:0}).to({scaleX:1,scaleY:1,alpha:1},250).wait(1e3).to({scaleX:2,scaleY:2,alpha:0},250).call(function(){return i.app.popScene()}),i.on("blur",function(){var t;return null!=(t=this.app)?t.pushScene(s.PauseScene()):void 0}),i}function r(){}var l=e((n(i,t).displayName="StageTitleScene",i),t).prototype;return r.prototype=l,i}(a.DisplayScene)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(t,e,i){(function(e){(function(){function n(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function o(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}var r,a,s,l,h,u=void 0!==i&&i||this;r="undefined"!=typeof window?window.phina:void 0!==e?e.phina:null,a=r.display,s=r.game,l=t("meta"),u.MyTitleScene=function(t){function e(){var t=this instanceof i?this:new i;return t.init({title:l.title,backgroundColor:"#36f"}),a.Label({text:"Version "+l.version,fill:"white",fontSize:32}).addChildTo(t).setPosition(t.gridX.center(),t.gridY.span(5)),h.each(function(e){return a.Label({text:e.text,align:e.align,fill:"white",fontSize:32}).addChildTo(t).setPosition(t.gridX.center(),t.gridY.span(9))}),t}function i(){}var r=n((o(e,t).displayName="MyTitleScene",e),t).prototype;return i.prototype=r,e}(s.TitleScene),h=[{text:"Move: \nGun: \nMissile: ",align:"right"},{text:"Touch\nTap Enemy\nLong Press",align:"left"}]}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{meta:5}],17:[function(t,e,i){(function(t){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}var o,r=void 0!==i&&i||this;o=("undefined"!=typeof window?window.phina:void 0!==t?t.phina:null).display,r.Explosion=function(t){function i(t,e){var i=this instanceof o?this:new o;return i.init({fill:"#ff9",radius:2,alpha:.9,stroke:!1}),i.permeable=!0,e/=2,i.tweener.to({radius:t/2},e).to({radius:t,alpha:0},e).call(function(){return i.remove()}),i}function o(){}var r=e((n(i,t).displayName="Explosion",i),t).prototype;return o.prototype=r,i}(o.CircleShape)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(t,e,i){(function(e){(function(){function n(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function o(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function r(t,e){for(var i in e)t[i]=e[i];return t}function a(t){function e(){}return e.prototype=t,new e}var s,l,h,u,d,c,f,p,y=void 0!==i&&i||this;s="undefined"!=typeof window?window.phina:void 0!==e?e.phina:null,l=s.display,h=s.geom,u=t("../util/calc").nrmYaw,d=t("../ex/shadowedrectangle").ShadowedRectangle,c=t("../ex/motion").Motion,f=t("../ex/particle").Particle,p=t("./explosion").Explosion,y.Missile=function(t){function e(t){var n=this instanceof i?this:new i;return n._=r(a(n._default),t),e.superclass.call(n,n._),l.CircleShape({fill:"#f93",radius:n.height,alpha:.9,stroke:!1}).addChildTo(n).setPosition(-n.width/2,0).tweener.to({radius:1.5*n.height,alpha:.1},100).to({radius:n.height,alpha:.9},100).setLoop(!0),n.side=n._.side,n._seekCount=n._.seekStart,n.motion=c(n._).attachTo(n),n.on("move",function(){var t=this;return this.parent.children.some(function(e){return!(e.permeable||e.side===t._.side||!t.hitTestElement(e))&&("function"==typeof e.damaged&&e.damaged(t._.damage),t._explosion(),!0)})}),n}function i(){}var s=n((o(e,t).displayName="Missile",e),t).prototype;return i.prototype=s,e.prototype.update=function(t){var e;if(null!=this.parent)return e=30*t.deltaTime/1e3,this._seekCount>0?this._seekCount-=e:this._maneuver(this._seek()),this._smoke(e)},e.prototype.damaged=function(){return this._explosion()},e.prototype._seek=function(){var t,e,i,n,o,r,a,s,l,d;for((t=[null,0,180])[0],e=t[1],i=t[2],n=0,o=(t=this.parent.children).length;n<o;++n)"function"==typeof(r=t[n]).isHeated&&r.isHeated()&&r.side!==this._.side&&(a=h.Vector2.sub(r.position,this.position).toAngle().toDegree(),s=u(a-this.rotation),(l=Math.abs(s))<=this._.seekAngle&&l<i&&((d=[r,s,l])[0],e=d[1],i=d[2]));return e},e.prototype._maneuver=function(t){return this.motion.yaw=t},e.prototype._smoke=function(t){if(this._.smokeRate*t>=Math.random())return f({fill:"white",radius:2,jitter:.5,animation:[{to:{radius:3*this.height,alpha:0},duration:1e3}]}).setPosition(this.x,this.y).addChildTo(this.parent)},e.prototype._explosion=function(){return p(30,250).setPosition(this.x,this.y).addChildTo(this.parent),this.remove()},e.prototype._default={width:12,height:4,stroke:!1,smokeRate:.5,resolution:5,side:"enemy",speed:2,accel:.2,speedMax:8,yawMax:.6,seekStart:30,seekAngle:45,damage:50},e}(d)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ex/motion":8,"../ex/particle":9,"../ex/shadowedrectangle":10,"../util/calc":22,"./explosion":17}],19:[function(t,e,i){(function(){function e(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function n(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function o(t,e){for(var i in e)t[i]=e[i];return t}function r(t){function e(){}return e.prototype=t,new e}var a,s,l,h=void 0!==i&&i||this;a=t("../ex/shadowedrectangle").ShadowedRectangle,s=t("../ex/motion").Motion,l=t("./explosion").Explosion,h.Shell=function(t){function i(t){var e=this instanceof a?this:new a;return e._=o(r(e._default),t),i.superclass.call(e,e._),e.permeable=!0,e.motion=s(e._).attachTo(e),e.on("move",function(){var t=this;return this.parent.children.some(function(e){return!(e.permeable||e.side===t._.side||!t.hitTestElement(e))&&("function"==typeof e.damaged&&e.damaged(t._.damage),l(16,200).setPosition(t.x,t.y).addChildTo(t.parent),t.remove(),!0)})}),e}function a(){}var h=e((n(i,t).displayName="Shell",i),t).prototype;return a.prototype=h,i.prototype._default={width:10,height:4,stroke:!1,resolution:5,side:"enemy",speed:12,damage:25},i}(a)}).call(this)},{"../ex/motion":8,"../ex/shadowedrectangle":10,"./explosion":17}],20:[function(t,e,i){(function(e){(function(){function n(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function o(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function r(t,e){for(var i in e)t[i]=e[i];return t}function a(t){function e(){}return e.prototype=t,new e}var s,l,h,u,d,c,f,p,y,w,g,m=void 0!==i&&i||this;s="undefined"!=typeof window?window.phina:void 0!==e?e.phina:null,l=s.display,h=s.geom,u=t("../util/calc").nrmYaw,d=t("../ex/shadowedrectangle").ShadowedRectangle,c=t("../ex/motion").Motion,f=t("../ex/particle").Particle,p=t("./turret").Turret,y=t("./shell").Shell,w=t("./missile").Missile,g=t("./explosion").Explosion,m.Tank=function(t){function e(t){var n,o,s=this instanceof i?this:new i;return s._=r(a(s._default),t),e.superclass.call(s,s._),s.motion=c(s._).attachTo(s),s.side=s._.side,s._hp=s._.hp,n=[s._.gunWait,s._.missileWait],s._gunWait=n[0],s._missileWait=n[1],o=r({width:s.width,height:s.height,fill:s.fill,stroke:s.stroke,strokeWidth:s.strokeWidth,shadow:s.shadow,shadowBlur:s.shadowBlur,shadowOffsetX:s.shadowOffsetX,shadowOffsetY:s.shadowOffsetY},s._.turret),s._turret=p(o).setRotation(0).setPosition(s.x,s.y).addChildTo(s),s.on("rotate",function(t){return this._turret.rotate(-t.angle)}),s}function i(){}var s=n((o(e,t).displayName="Tank",e),t).prototype;return i.prototype=s,e.prototype.update=function(t){var e;if(null!=this.parent&&(e=30*t.deltaTime/1e3,this._smoke(e),this._drive(),this._gunWait>0&&(this._gunWait-=e),this._missileWait>0))return this._missileWait-=e},e.prototype.moving=function(){return null!=this._target},e.prototype.entry=function(t){return t.addTank(this),this},e.prototype.damaged=function(t){if(this._hp>0&&(this._hp-=t,this._hp<=0))return this._killed()},e.prototype.cmdMove=function(t){var e,i;if((null==(e=this._target)||!e.equals(t))&&(this._target=t.clone(),this._.marker&&null!=this.parent))return null!=(i=this._marker)&&i.remove(),this._marker=l.CircleShape({radius:2,fill:"#06f",stroke:!1,alpha:.7}).setPosition(t.x,t.y).addChildTo(this.parent),this._marker.tweener.set({radius:2}).wait(0).set({alpha:.7}).to({radius:12,alpha:0},500).setLoop(!0)},e.prototype.cmdGun=function(t){var e=this;if(this._gunWait<=0)return this._gunWait=this._.gunWait,this._turret.fireWeapon(t,function(t,i){return e._fire(y,t,i,e._.shell)})},e.prototype.cmdMissile=function(t){var e=this;if(this._missileWait<=0)return this._missileWait=this._.missileWait,this._turret.fireWeapon(t,function(t,i){return e._fire(w,t,i,e._.missile)})},e.prototype.escapeCrew=function(){var t,e,i,n,o=[];for(this._clearTarget(),t=0,i=(e=this.accessories).length;t<i;++t)(n=e[t])instanceof c||o.push(n.remove());return o},e.prototype.isHeated=function(){return!0},e.prototype._clearTarget=function(){if(this._target=null,null!=this._marker)return this._marker.remove(),this._marker=null},e.prototype._drive=function(){var t,e,i,n;return t=[this._.brake,0],e=t[0],i=t[1],null!=this._target&&(h.Rect(this.left,this.top,this.width,this.height).contains(this._target.x,this._target.y)?this._clearTarget():(n=h.Vector2.sub(this._target,this.position),-60<(i=u(n.toAngle().toDegree()-this.rotation))&&i<60&&(e=this._.accel))),t=[e,i],this.motion.accel=t[0],this.motion.yaw=t[1],t},e.prototype._fire=function(t,e,i,n){return t(r(a(n),{fill:this.fill,padding:this.padding,side:this.side,shadow:this.shadow,shadowBlur:this.shadowBlur,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY})).setPosition(e.x,e.y).setRotation(i).addChildTo(this.parent)},e.prototype._smoke=function(t){if(.4,t*(1-Math.sqrt(this._hp/this._.hp))*.4>Math.random())return f({fill:"grey",radius:2,direction:-45,speed:1,jitter:.5,animation:[{to:{radius:12,alpha:0},duration:2e3}]}).setPosition(this.x,this.y).addChildTo(this.parent)},e.prototype._killed=function(){var t=this;return this.escapeCrew(),this.tweener.wait(1e3).call(function(){return t._explosion()}).wait(300).call(function(){return t.setVisible(!1)}).wait(200).call(function(){return t.parent.flare("killed",{tank:t}),t.remove()})},e.prototype._explosion=function(){return g(60,500).setPosition(this.x,this.y).addChildTo(this.parent)},Object.defineProperty(e.prototype,"gunRate",{get:function(){return 100*(1-this._gunWait/this._.gunWait)},configurable:!0,enumerable:!0}),Object.defineProperty(e.prototype,"missileRate",{get:function(){return 100*(1-this._missileWait/this._.missileWait)},configurable:!0,enumerable:!0}),e.prototype._default={width:48,height:24,padding:8,stroke:"#333",strokeWidth:1,shadow:"rgba(0, 0, 0, 0.5)",shadowBlur:4,shadowOffsetX:4,shadowOffsetY:4,hp:100,side:"enemy",marker:!1,speedMax:3,yawMax:10,accel:.2,brake:-.5,gunWait:60,missileWait:300},e}(d)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ex/motion":8,"../ex/particle":9,"../ex/shadowedrectangle":10,"../util/calc":22,"./explosion":17,"./missile":18,"./shell":19,"./turret":21}],21:[function(t,e,i){(function(e){(function(){function n(t,e){function i(){}return i.prototype=(t.superclass=e).prototype,(t.prototype=new i).constructor=t,"function"==typeof e.extended&&e.extended(t),t}function o(t,e){var i={}.hasOwnProperty;for(var n in e)i.call(e,n)&&(t[n]=e[n]);return t}function r(t,e){for(var i in e)t[i]=e[i];return t}function a(t){function e(){}return e.prototype=t,new e}var s,l,h,u,d,c,f=void 0!==i&&i||this;l=(s="undefined"!=typeof window?window.phina:void 0!==e?e.phina:null).display,h=s.geom,u=t("../util/calc").nrmYaw,d=t("../util/vector").rotate,c=t("../ex/shadowedrectangle").ShadowedRectangle,f.Turret=function(t){function e(t){var e,n,o=this instanceof i?this:new i;return o._=r({cornerRadius:4,yawMax:30,barrelLength:1.2},t),o._.width=o._.height=.9*Math.min(o._.width,o._.height),o.init(o._),n=a(o._),n.width=o.width*o._.barrelLength,n.height=.2*o.height,n.cornerRadius=0,e=n,o._barrel=c(e),o._barrel.setOrigin(0,.5).setPosition(o.width/2-o._barrel.padding,0).addChildTo(o),c(o._).setPosition(0,0).addChildTo(o),o}function i(){}var s=n((o(e,t).displayName="Turret",e),t).prototype;return i.prototype=s,e.prototype.update=function(t){var e,i,n,o,r,a,s;if(null!=this._target&&(e=this._.yawMax*t.deltaTime*30/1e3,i=this.position.clone().add(this.parent.position),n=h.Vector2.sub(this._target,i).toAngle().toDegree(),o=u(n-this.rotation-this.parent.rotation),r=Math.clamp(o,-e,e),this.rotate(r),o===r))return a=h.Vector2(this._barrel.right,this._barrel.centerY),(s=d(a,(this.rotation+this.parent.rotation).toRadian())).add(this.parent.position),"function"==typeof this._fireFunc&&this._fireFunc(s,n),this._target=this._fireFunc=null},e.prototype.fireWeapon=function(t,e){return this._fireFunc=e,this._target=t.clone()},e.prototype.rotate=function(t){return this.rotation+=t},e}(l.DisplayElement)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ex/shadowedrectangle":10,"../util/calc":22,"../util/vector":24}],22:[function(t,e,i){(function(){(void 0!==i&&i||this).nrmYaw=function(t){return((t+180)%360+360)%360-180}}).call(this)},{}],23:[function(t,e,i){(function(){(void 0!==i&&i||this).setOrigin2=function(t,e,i){var n,o,r,a,s,l,h=[];for(n=(e-t.originX)*t.width,o=(i-t.originY)*t.height,t.setOrigin(e,i),t.x+=n,t.y+=o,r=0,s=(a=t.children).length;r<s;++r)null!=(l=a[r]).x&&null!=l.y&&(l.x-=n,h.push(l.y-=o));return h}}).call(this)},{}],24:[function(t,e,i){(function(t){(function(){var e,n=void 0!==i&&i||this;e=("undefined"!=typeof window?window.phina:void 0!==t?t.phina:null).geom,n.applyMargin=function(t,i,n){var o,r;return o=Math.clamp(t.x,i.left+n,i.right-n),r=Math.clamp(t.y,i.top+n,i.bottom-n),e.Vector2(o,r)},n.rotate=function(t,i){var n;if((n=t.length())>0)return e.Vector2().fromAngle(t.toAngle()+i,n)}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[11]);